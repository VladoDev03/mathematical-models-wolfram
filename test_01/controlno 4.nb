Notebook[{Cell[
CellGroupData[{Cell[
BoxData[{RowBox[{"Knapsack[weights_, values_, capacity_] := Module[{n, dp, selectedItems, w, i},\n  n = Length[weights];\n  dp = Table[0, {i, 0, n}, {w, 0, capacity}];\n  \n  (* \:0417\:0430\:043f\:044a\:043b\:0432\:0430\:043d\:0435 \:043d\:0430 \:0442\:0430\:0431\:043b\:0438\:0446\:0430\:0442\:0430 \:0437\:0430 \:0434\:0438\:043d\:0430\:043c\:0438\:0447\:043d\:043e \:043f\:0440\:043e\:0433\:0440\:0430\:043c\:0438\:0440\:0430\:043d\:0435 *)\n  For[i = 1, i \[LessEqual] n, i++,\n    For[w = 0, w \[LessEqual] capacity, w++,\n      If[weights[[i]] > w,\n        dp[[i + 1, w + 1]] = dp[[i, w + 1]],\n        dp[[i + 1, w + 1]] = Max[dp[[i, w + 1]], dp[[i, w + 1 - weights[[i]]]] + values[[i]]]\n      ]\n    ]\n  ];\n\n  (* \:041d\:0430\:043c\:0438\:0440\:0430\:043d\:0435 \:043d\:0430 \:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:043d\:0430\:0442\:0430 \:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442 \:0438 \:0441\:044a\:0431\:0438\:0440\:0430\:043d\:0435 \:043d\:0430 \:0438\:0437\:0431\:0440\:0430\:043d\:0438\:0442\:0435 \:043f\:0440\:0435\:0434\:043c\:0435\:0442\:0438 *)\n  selectedItems = {};\n  w = capacity;\n  For[i = n, i \[GreaterEqual] 1, i--,\n    If[dp[[i + 1, w + 1]] \[NotEqual] dp[[i, w + 1]],\n      AppendTo[selectedItems, {weights[[i]], values[[i]]}];\n      w -= weights[[i]];\n    ]\n  ];\n\n  (* \:0412\:0440\:044a\:0449\:0430\:043d\:0435 \:043d\:0430 \:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:043d\:0430\:0442\:0430 \:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442 \:0438 \:0438\:0437\:0431\:0440\:0430\:043d\:0438\:0442\:0435 \:043f\:0440\:0435\:0434\:043c\:0435\:0442\:0438 *)\n  {dp[[n + 1, capacity + 1]], selectedItems}\n]"}],"\n\n",RowBox[
{"(* \:0414\:0430\:043d\:043d\:0438 *)\nweights = {41, 47, 51, 6, 17, 11, 19};"}],"\n",RowBox[
{"values = {32, 34, 35, 8, 23, 15, 10};"}],"\n",RowBox[{"capacity = 311;"}],"\n\n",RowBox[
{"(* \:0420\:0435\:0448\:0435\:043d\:0438\:0435 *)\n{maxValue, selectedItems} = Knapsack[weights, values, capacity];"}],"\n",RowBox[
{"Print[\"\:041c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:043d\:0430\:0442\:0430 \:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442, \:043a\:043e\:044f\:0442\:043e \:043c\:043e\:0436\:0435 \:0434\:0430 \:0431\:044a\:0434\:0435 \:0432\:0437\:0435\:0442\:0430 \:0435: \", maxValue];"}],"\n",RowBox[
{"Print[\"\:0418\:0437\:0431\:0440\:0430\:043d\:0438\:0442\:0435 \:043f\:0440\:0435\:0434\:043c\:0435\:0442\:0438 \:0441\:0430 (\:0442\:0435\:0433\:043b\:043e, \:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442): \", selectedItems];\n"}]}],
"Input",CellLabel -> "In[20]:= ",ExpressionUUID -> "00e4300c-cb34-46ca-8da3-e1a566e03876"],Cell[
BoxData[
InterpretationBox[RowBox[{"\"\:041c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:043d\:0430\:0442\:0430 \:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442, \:043a\:043e\:044f\:0442\:043e \:043c\:043e\:0436\:0435 \:0434\:0430 \:0431\:044a\:0434\:0435 \:0432\:0437\:0435\:0442\:0430 \:0435: \"","\[InvisibleSpace]","157"}],
SequenceForm["\:041c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:043d\:0430\:0442\:0430 \:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442, \:043a\:043e\:044f\:0442\:043e \:043c\:043e\:0436\:0435 \:0434\:0430 \:0431\:044a\:0434\:0435 \:0432\:0437\:0435\:0442\:0430 \:0435: ",
157],Editable -> False],StandardForm],"Print",ExpressionUUID -> "e0fcdd28-dcb7-4fcf-bc53-5c5b51d61f6e"],Cell[
BoxData[
InterpretationBox[RowBox[{"\"\:0418\:0437\:0431\:0440\:0430\:043d\:0438\:0442\:0435 \:043f\:0440\:0435\:0434\:043c\:0435\:0442\:0438 \:0441\:0430 (\:0442\:0435\:0433\:043b\:043e, \:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442): \"","\[InvisibleSpace]",RowBox[
{"{",RowBox[{RowBox[{"{",RowBox[{"19",",","10"}],"}"}],",",RowBox[{"{",RowBox[{"11",",","15"}],"}"}],",",RowBox[
{"{",RowBox[{"17",",","23"}],"}"}],",",RowBox[{"{",RowBox[{"6",",","8"}],"}"}],",",RowBox[
{"{",RowBox[{"51",",","35"}],"}"}],",",RowBox[{"{",RowBox[{"47",",","34"}],"}"}],",",RowBox[
{"{",RowBox[{"41",",","32"}],"}"}]}],"}"}]}],SequenceForm["\:0418\:0437\:0431\:0440\:0430\:043d\:0438\:0442\:0435 \:043f\:0440\:0435\:0434\:043c\:0435\:0442\:0438 \:0441\:0430 (\:0442\:0435\:0433\:043b\:043e, \:0441\:0442\:043e\:0439\:043d\:043e\:0441\:0442): ",
{{19,10},{11,15},{17,23},{6,8},{51,35},{47,34},{41,32}}],Editable -> False],StandardForm],
"Print",ExpressionUUID -> "9a291e6e-5e7d-4cd1-b242-951ada6cd210"]},Open],ExpressionUUID -> "8035bcb3-5b85-4e3e-98f9-17276dc8997d"]},
StyleDefinitions -> "Default.nb",FrontEndVersion -> "14.1 for Wolfram Cloud 1.70 (October 17, 2024)"]